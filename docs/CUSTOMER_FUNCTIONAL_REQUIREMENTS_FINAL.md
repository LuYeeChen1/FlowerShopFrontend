# CUSTOMER_FUNCTIONAL_REQUIREMENTS_FINAL.md
# FlowerShop — CUSTOMER（顾客）功能需求说明书（最终版 FRD）

> **文档定位**
>
> - 文档类型：Functional Requirements Document（功能需求说明书）
> - 目标：**定义顾客能做什么、系统必须表现出什么行为**
> - 不包含：任何技术实现、架构设计、数据库结构、API 设计、云服务方案
> - 适用对象：产品负责人、需求分析、测试人员、以及后续的实现者（含 Codex）
>
> 本文档是 **CUSTOMER 端的唯一需求真相（Single Source of Truth）**。

---

## 1. 文档元信息

- 产品名称：FlowerShop
- 模块：CUSTOMER（顾客端）
- 版本：v1.0 FINAL
- 状态：冻结（Frozen）
- 范围：顾客从注册到下单、支付、履约感知、售后、评价、客服的**完整功能需求**
- 不在范围：SELLER / ADMIN 的内部操作与实现细节

---

## 2. 角色与访问边界（Roles & Boundaries）

### 2.1 角色定义

| 角色 | 描述 |
|---|---|
| Guest（游客） | 未登录用户，仅可浏览公开信息 |
| Customer（顾客） | 已登录用户，可进行购买与售后等操作 |

### 2.2 权限与所有权原则

- FR-SEC-001：顾客只能访问**属于自己的**资源（订单、地址、售后、工单等）
- FR-SEC-002：顾客不得感知不属于自己的资源是否存在
- FR-SEC-003：未登录用户不得访问任何“受保护功能”

---

## 3. 顾客完整能力地图（Capability Map）

1. 身份与账户
2. 个人资料管理
3. 地址簿管理
4. 商品发现（浏览 / 搜索 / 筛选）
5. 商品详情
6. 收藏 / 愿望清单
7. 购物车
8. 结算
9. 订单管理
10. 支付
11. 物流查看
12. 评价系统
13. 售后（退款 / 退货 / 换货）
14. 优惠券
15. 通知中心
16. 客服工单

---

## 4. 核心用户旅程（End-to-End Journeys）

### 4.1 标准购买旅程（必须完整支持）

1. 顾客注册或登录
2. 浏览 / 搜索商品
3. 查看商品详情
4. 加入购物车
5. 进入结算
6. 选择地址并确认金额
7. 创建订单
8. 支付订单
9. 查看订单状态
10. 查看物流
11. 确认收货
12. 评价商品

### 4.2 扩展旅程

- 取消订单
- 使用优惠券
- 发起售后
- 接收通知
- 创建客服工单

---

## 5. 功能需求（Functional Requirements）

以下所有需求均以 **FR-CUST-<模块>-<编号>** 标识。

---

# A. 身份与账户（Account & Identity）

## A1 注册

- FR-CUST-AUTH-001：系统必须允许游客注册为顾客
- FR-CUST-AUTH-002：注册成功后，顾客必须能够使用该账号登录
- FR-CUST-AUTH-003：系统必须校验注册输入的完整性与合法性
- FR-CUST-AUTH-004：系统必须拒绝重复账号注册并给出明确提示

**验收标准（GWT）**

- Given：用户未注册  
- When：提交合法注册信息  
- Then：账号创建成功并可登录  

---

## A2 登录

- FR-CUST-AUTH-010：系统必须允许已注册顾客登录
- FR-CUST-AUTH-011：登录失败必须有明确的失败反馈
- FR-CUST-AUTH-012：登录成功后顾客可访问受保护功能

---

## A3 登出

- FR-CUST-AUTH-020：系统必须允许顾客登出
- FR-CUST-AUTH-021：登出后访问受保护功能必须失败

---

## A4 忘记 / 重置密码

- FR-CUST-AUTH-030：系统必须支持顾客发起密码重置
- FR-CUST-AUTH-031：顾客完成重置后可用新密码登录

---

# B. 个人资料（Profile）

## B1 查看资料

- FR-CUST-PROF-001：系统必须允许顾客查看自己的资料

## B2 修改资料

- FR-CUST-PROF-010：系统必须允许顾客更新个人资料
- FR-CUST-PROF-011：系统必须保护不可修改字段（如唯一身份）

---

# C. 地址簿（Address Book）

## C1 地址管理

- FR-CUST-ADDR-001：顾客可以新增收货地址
- FR-CUST-ADDR-002：顾客可以编辑收货地址
- FR-CUST-ADDR-003：顾客可以删除收货地址
- FR-CUST-ADDR-004：顾客可以查看地址列表

## C2 默认地址规则

- FR-CUST-ADDR-010：顾客可设置默认地址
- FR-CUST-ADDR-011：系统必须保证每位顾客最多一个默认地址
- FR-CUST-ADDR-012：删除默认地址时，系统必须有确定性行为

---

# D. 商品发现（Catalog）

## D1 浏览商品

- FR-CUST-CAT-001：游客与顾客均可浏览商品列表
- FR-CUST-CAT-002：系统必须支持分页
- FR-CUST-CAT-003：系统必须支持至少一种排序方式

## D2 搜索与筛选

- FR-CUST-CAT-010：系统必须支持关键字搜索
- FR-CUST-CAT-020：系统必须支持基础筛选（类目、价格、是否有货）

---

# E. 商品详情（Product Detail）

- FR-CUST-PDP-001：系统必须展示商品完整信息
- FR-CUST-PDP-002：系统必须清晰展示商品是否可售
- FR-CUST-PDP-003：系统必须展示评价摘要

---

# F. 收藏 / 愿望清单（Wishlist）

- FR-CUST-WISH-001：顾客可以收藏商品
- FR-CUST-WISH-002：顾客可以取消收藏
- FR-CUST-WISH-003：顾客可以查看收藏列表

---

# G. 购物车（Cart）

## G1 基本操作

- FR-CUST-CART-001：顾客可以加入商品到购物车
- FR-CUST-CART-002：顾客可以修改商品数量
- FR-CUST-CART-003：顾客可以移除商品
- FR-CUST-CART-004：顾客可以清空购物车
- FR-CUST-CART-005：顾客可以查看购物车

## G2 校验规则

- FR-CUST-CART-010：数量必须为正整数
- FR-CUST-CART-011：数量不得超过可售库存
- FR-CUST-CART-020：不可售商品必须阻止结算

---

# H. 结算（Checkout）

- FR-CUST-CKO-001：顾客可以选择收货地址
- FR-CUST-CKO-002：系统必须展示订单金额明细
- FR-CUST-CKO-010：结算金额与最终订单金额必须一致或可解释
- FR-CUST-CKO-020：系统必须支持优惠券校验（若启用）

---

# I. 订单（Orders）

## I1 创建订单

- FR-CUST-ORD-001：顾客可以创建订单
- FR-CUST-ORD-002：系统必须校验库存与商品可售性
- FR-CUST-ORD-003：系统必须固化订单快照
- FR-CUST-ORD-004：系统必须返回订单标识

## I2 查看订单

- FR-CUST-ORD-010：顾客可以查看订单列表
- FR-CUST-ORD-011：顾客可以查看订单详情

## I3 订单状态（顾客视角）

### 订单状态集合

- 待支付
- 已支付 / 待发货
- 已发货
- 已收货 / 已完成
- 已取消
- 退款中 / 已退款（如适用）

## I4 订单操作规则

- FR-CUST-ORD-030：待支付订单必须允许取消
- FR-CUST-ORD-031：不允许取消的状态必须明确拒绝
- FR-CUST-ORD-040：已发货订单必须允许确认收货
- FR-CUST-ORD-041：未发货订单不得确认收货

---

# J. 支付（Payment）

- FR-CUST-PAY-001：顾客可以对订单发起支付
- FR-CUST-PAY-002：系统必须反馈支付结果
- FR-CUST-PAY-010：支付失败后允许再次支付（若订单仍有效）
- FR-CUST-PAY-011：已支付订单不得重复支付

---

# K. 物流（Shipment）

- FR-CUST-SHP-001：顾客可以查看物流信息
- FR-CUST-SHP-002：未发货订单必须显示“待发货”状态

---

# L. 评价（Reviews）

- FR-CUST-REV-001：顾客可以评价已购买商品
- FR-CUST-REV-002：系统必须限制评价资格（已完成订单）
- FR-CUST-REV-003：同一订单项只能评价一次

---

# M. 售后（After-sales）

## M1 发起售后

- FR-CUST-AS-001：顾客可以对订单/订单项发起售后
- FR-CUST-AS-002：系统至少支持退款类型
- FR-CUST-AS-003：顾客可以提交原因与证据

## M2 售后规则

- FR-CUST-AS-010：系统必须定义售后申请窗口
- FR-CUST-AS-011：同一订单项不得存在多个未关闭售后

## M3 售后跟踪

- FR-CUST-AS-020：顾客可以查看售后列表与详情
- FR-CUST-AS-021：系统必须展示售后状态变化

---

# N. 优惠券（Coupons）

- FR-CUST-CPN-001：顾客可以查看可用优惠券
- FR-CUST-CPN-002：系统必须校验优惠券适用性
- FR-CUST-CPN-003：订单中必须体现优惠结果

---

# O. 通知（Notifications）

- FR-CUST-NOTI-001：顾客可以查看通知列表
- FR-CUST-NOTI-002：顾客可以标记通知为已读
- FR-CUST-NOTI-003：关键事件必须生成通知

---

# P. 客服工单（Support）

- FR-CUST-SUP-001：顾客可以创建客服工单
- FR-CUST-SUP-002：顾客可以在工单中发送消息
- FR-CUST-SUP-003：顾客可以查看工单状态与历史

---

## 6. 非目标（Out of Scope）

- SELLER / ADMIN 内部操作流程
- 技术架构、数据库、API 设计
- 推荐算法与搜索算法实现
- 支付网关集成细节

---
